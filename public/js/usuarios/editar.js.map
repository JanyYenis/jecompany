{"version":3,"file":"/js/usuarios/editar.js","mappings":"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","sources":["webpack:///./resources/js/usuarios/editar.js"],"sourcesContent":["\"use strict\";\r\n\r\nconst formEditarUsuario = \"#formEditarUsuario\";\r\n\r\n$(function () {\r\n    iniciarComponentes();\r\n    generalidades.validarFormulario(formEditarUsuario, enviarDatos);\r\n});\r\n\r\nconst iniciarComponentes = (form = \"\") => {\r\n    const input = document.querySelector(\"#tel\");\r\n    window.intlTelInput(input, {\r\n        utilsScript: \"https://cdn.jsdelivr.net/npm/intl-tel-input@18.1.1/build/js/utils.js\",\r\n        initialCountry: \"CO\",\r\n    });\r\n\r\n    let element = document.querySelector(\"#kt_stepper_example_clickable\");\r\n    let stepper = new KTStepper(element);\r\n    stepper.on(\"kt.stepper.click\", function (stepper) {\r\n        stepper.goTo(stepper.getClickedStepIndex()); // go to clicked step\r\n    });\r\n    stepper.on(\"kt.stepper.next\", function (stepper) {\r\n        stepper.goNext(); // go next step\r\n    });\r\n    stepper.on(\"kt.stepper.previous\", function (stepper) {\r\n        stepper.goPrevious(); // go previous step\r\n    });\r\n\r\n    // Email address\r\n    Inputmask({\r\n        mask: \"*{1,20}[.*{1,20}][.*{1,20}][.*{1,20}]@*{1,20}[.*{2,6}][.*{1,2}]\",\r\n        greedy: false,\r\n        onBeforePaste: function (pastedValue, opts) {\r\n            pastedValue = pastedValue.toLowerCase();\r\n            return pastedValue.replace(\"mailto:\", \"\");\r\n        },\r\n        definitions: {\r\n            \"*\": {\r\n                validator: '[0-9A-Za-z!#$%&\"*+/=?^_`{|}~\\-]',\r\n                cardinality: 1,\r\n                casing: \"lower\"\r\n            }\r\n        }\r\n    }).mask(\"#inputEmail\");\r\n    \r\n    // Phone\r\n    Inputmask({\r\n        \"mask\" : \"(999) 999-9999\"\r\n    }).mask(\"#tel\");\r\n\r\n    $(\"#kt_datepicker_1\").flatpickr();\r\n\r\n    $('#kt_docs_repeater_basic').repeater({\r\n        initEmpty: false,\r\n\r\n        defaultValues: {\r\n            'text-input': 'foo'\r\n        },\r\n\r\n        show: function () {\r\n            $(this).slideDown();\r\n        },\r\n\r\n        hide: function (deleteElement) {\r\n            $(this).slideUp(deleteElement);\r\n        }\r\n    });\r\n\r\n    // Format options\r\n    var optionFormat = function(item) {\r\n        if ( !item.id ) {\r\n            return item.text;\r\n        }\r\n\r\n        var span = document.createElement('span');\r\n        var imgUrl = item.element.getAttribute('data-kt-select2-country');\r\n        var template = '';\r\n\r\n        template += '<img src=\"' + imgUrl + '\" class=\"rounded-circle h-40px w-40px me-4\" alt=\"image\"/>';\r\n        template += item.text;\r\n\r\n        span.innerHTML = template;\r\n\r\n        return $(span);\r\n    }\r\n\r\n    // Init Select2 --- more info: https://select2.org/\r\n    $('#selectPais').select2({\r\n        templateSelection: optionFormat,\r\n        templateResult: optionFormat\r\n    });\r\n\r\n    $(document).on('change', '#selectPais', function(){\r\n        if (this.value) {\r\n            $.ajax({\r\n                type: 'GET',\r\n                url: route('ciudades.buscar', {'pais': this.value}),\r\n                success: function(response) {\r\n                    if (response.estado == 'success') {\r\n                        let ciudades = response?.ciudades ?? [];\r\n                        let selectCiudad = $(`#selectCiudad`);\r\n                        selectCiudad.empty();\r\n                        let opcion = new Option('', '', false, false);\r\n                        selectCiudad.append(opcion);\r\n                        ciudades.forEach((ciudad) => {\r\n                            let selected = false;\r\n                            if (selectCiudad.attr('data-ciudad') && selectCiudad.attr('data-ciudad') == ciudad.id) {\r\n                                selected = true;\r\n                            }\r\n                            selectCiudad.append(new Option(ciudad.text, ciudad.id, selected, selected));\r\n                        });\r\n                        $('#selectCiudad').attr('disabled', false);\r\n                    }\r\n                    generalidades.toastrGenerico(response?.estado, response?.mensaje);\r\n                    // $('.divOpciones').removeClass('d-none');\r\n                }\r\n            });\r\n        } else {\r\n            $('#selectCiudad').attr('disabled', true);\r\n        }\r\n    });\r\n\r\n    $('#selectPais').trigger('change');\r\n}\r\n\r\nconst enviarDatos = (form) => {\r\n    let formData = new FormData(document.getElementById(\"formEditarUsuario\"));\r\n    let inputTelefono = generalidades.darTelefonoInput(`${formEditarUsuario} #tel`);\r\n\tlet tel = inputTelefono?.getNumber(intlTelInputUtils.numberFormat.NATIONAL);\r\n    tel = tel.replace(/\\((\\w+)\\)/g, \"$1\");\r\n    tel = tel.replace(/-/g, \"\");\r\n\tlet codigo = inputTelefono?.getSelectedCountryData()?.dialCode ?? '';\r\n\tlet pais_tel = inputTelefono?.getSelectedCountryData()?.iso2 ?? '';\r\n    formData.set('telefono', tel);\r\n    formData.set('codigo_tel', codigo);\r\n    formData.set('pais_tel', pais_tel);\r\n    let imageInput = document.getElementById('avatarUsuario');\r\n    let imageFile = imageInput.files[0];\r\n    console.log(imageFile);\r\n    formData.set('image', imageFile);\r\n    \r\n    const config = {\r\n        'method': 'PUT',\r\n        'headers': {\r\n            'Accept': generalidades.CONTENT_TYPE_JSON,\r\n        },\r\n        'body': formData\r\n    }\r\n\r\n    const success = (response) => {\r\n        if (formData.get('avatar')) {\r\n            $.ajax({\r\n                type: 'POST',\r\n                url: route('usuarios.guardarImagen'),\r\n                headers: {\r\n                    'X-CSRF-TOKEN': $('meta[name=\"csrf-token\"]').attr('content'),\r\n                },\r\n                data: formData,\r\n                processData: false, // Evita que jQuery procese los datos\r\n                contentType: false, // Evita que jQuery establezca el encabezado 'Content-Type'\r\n                success: function(response) {\r\n                    if (response.estado == 'success') {\r\n                        generalidades.ocultarValidaciones(formEditarUsuario);\r\n                    }\r\n                    generalidades.ocultarCargando(formEditarUsuario);\r\n                    generalidades.toastrGenerico(response?.estado, response?.mensaje);\r\n                    location.reload();\r\n                },\r\n                error: function(response) {\r\n                    generalidades.ocultarCargando(formEditarUsuario);\r\n                    generalidades.toastrGenerico(response?.estado, response?.mensaje);\r\n                    generalidades.mostrarValidaciones(formEditarUsuario, response.validaciones);\r\n                }\r\n            });\r\n        } else {\r\n            if (response.estado == 'success') {\r\n                generalidades.ocultarValidaciones(formEditarUsuario);\r\n            }\r\n            generalidades.ocultarCargando(formEditarUsuario);\r\n            generalidades.toastrGenerico(response?.estado, response?.mensaje);\r\n            location.reload();\r\n        }\r\n    }\r\n\r\n    const error = (response) => {\r\n        generalidades.ocultarCargando(formEditarUsuario);\r\n        generalidades.toastrGenerico(response?.estado, response?.mensaje);\r\n        generalidades.mostrarValidaciones(formEditarUsuario, response.validaciones);\r\n    }\r\n    const rutaActualizar = route(\"usuarios.update\", { \"usuario\": formData.get(\"id\") });\r\n    generalidades.edit(rutaActualizar, config, success, error);\r\n    generalidades.mostrarCargando(formEditarUsuario);\r\n}"],"names":["formEditarUsuario","$","iniciarComponentes","generalidades","validarFormulario","enviarDatos","input","document","querySelector","window","intlTelInput","utilsScript","initialCountry","element","stepper","KTStepper","on","goTo","getClickedStepIndex","goNext","goPrevious","Inputmask","mask","greedy","onBeforePaste","pastedValue","opts","toLowerCase","replace","definitions","validator","cardinality","casing","flatpickr","repeater","initEmpty","defaultValues","show","this","slideDown","hide","deleteElement","slideUp","optionFormat","item","id","text","span","createElement","template","getAttribute","innerHTML","select2","templateSelection","templateResult","value","ajax","type","url","route","success","response","estado","_response$ciudades","ciudades","selectCiudad","empty","opcion","Option","append","forEach","ciudad","selected","attr","toastrGenerico","mensaje","trigger","form","_inputTelefono$getSel","_inputTelefono$getSel2","_inputTelefono$getSel3","_inputTelefono$getSel4","formData","FormData","getElementById","inputTelefono","darTelefonoInput","concat","tel","getNumber","intlTelInputUtils","numberFormat","NATIONAL","codigo","getSelectedCountryData","dialCode","pais_tel","iso2","set","imageFile","files","console","log","config","CONTENT_TYPE_JSON","rutaActualizar","get","edit","headers","data","processData","contentType","ocultarValidaciones","ocultarCargando","location","reload","error","mostrarValidaciones","validaciones","mostrarCargando"],"sourceRoot":""}